<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CATEGORIES</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="/images/SAU-LOGO.svg">
    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="/css/main-admin.css">
</head>

<body>
<header class="header">
    <nav>
        <a href="#" onclick="getAllCategories()">Категории</a>
        <a href="/category/add" class="btn btn-primary">Добавить</a>
    </nav>
</header>

<main class="main">
    <div class="container">
        <table class="table">
            <thead class="thead-light">
            <tr>
                <th scope="col">SN</th>
                <th scope="col">Название категории</th>
                <th scope="col">Удалить</th>
                <th scope="col">Обновить</th>
            </tr>
            </thead>
            <tbody class="tbody-light" id="categoryTableBody">
            <!-- Categories will be dynamically inserted here -->
            </tbody>
        </table>
    </div>
</main>

<script>
    function getAllCategories() {
        // Replace this with actual backend API endpoint
        fetch('/category/all')
            .then(response => response.json())
            .then(categories => {
                displayCategories(categories);
            })
            .catch(error => console.error('Error fetching categories:', error));
    }

    function displayCategories(categories) {
        const tableBody = document.getElementById('categoryTableBody');
        tableBody.innerHTML = ''; // Clear existing rows

        categories.forEach((category, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <th scope="row">${index + 1}</th>
                <td>${category.name}</td>
                <td>${category.image}</td>
                <td><a href="#" onclick="deleteCategory(${category.id})" class="btn-delete">Удалить</a></td>
                <td><a href="#" onclick="updateCategory(${category.id})" class="btn-update">Обновить</a></td>
            `;
            tableBody.appendChild(row);
        });
    }

    function deleteCategory(categoryId) {
        // Replace this with actual backend API endpoint and method
        fetch(`/category/delete/${categoryId}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            // You may need to pass additional data in the body
            body: JSON.stringify({ id: categoryId })
        })
            .then(response => response.text())
            .then(responseText => {
                console.log(responseText);
                // Update the UI after successful deletion, e.g., by fetching all categories again
                getAllCategories();
            })
            .catch(error => console.error('Error deleting category:', error));
    }

    function updateCategory(categoryId) {
        // Replace this with actual backend API endpoint and method
        fetch(`/category/update/${categoryId}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            // You may need to pass additional data in the body
            body: JSON.stringify({ /* updated data */ })
        })
            .then(response => response.text())
            .then(responseText => {
                console.log(responseText);
                // Update the UI after successful update, e.g., by fetching all categories again
                getAllCategories();
            })
            .catch(error => console.error('Error updating category:', error));
    }

    // Initial fetch of all categories when the page loads
    getAllCategories();
</script>

</body>
</html>
